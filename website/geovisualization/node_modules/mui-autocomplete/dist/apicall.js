"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _axios = _interopRequireDefault(require("axios"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

//useApi Hook: Handling form events
var useApi = function useApi(url, setAction, setError, setItems, setIsOpen, setValue) {
  var fetchAll = function fetchAll(value) {
    var ApiUrl = url + value;
    setAction('loading');

    _axios["default"].get(ApiUrl).then(function (response) {
      setAction('complete'); // Receive server response if the status is ok(200, 201).

      if (response.status === 200 || response.status === 201) {
        // Response: setting the retrieved data.
        if (response.data.posts) {
          setItems(response.data.posts);
          setIsOpen(true);
        } // Response: setting the message.


        if (response.data.message && items.length > 0) {
          setIsOpen(false);
          return setError(response.data.message);
        }
      }
    })["catch"](function (err) {
      // IF Server request failed.
      setError(err.message);
      setIsOpen(false);
      setAction('search');
    });
  }; // Api call to fetch data by id


  var fetchById = function fetchById(url, value, title) {
    var ApiUrl = url + value;
    setAction('loading');

    _axios["default"].get(ApiUrl).then(function (response) {
      setAction('complete'); // Receive server response if the status is ok(200, 201).

      if (response.status === 200 || response.status === 201) {
        // Response: setting the retrieved data.
        if (response.data.post) {
          setValue(response.data.post[title]);
        } // Response: setting the message.


        if (response.data.message && items.length > 0) {
          return setError(response.data.message);
        }
      }
    })["catch"](function (err) {
      // IF Server request failed.
      setError(err.message);
      setAction('search');
    });
  };

  return {
    fetchAll: fetchAll,
    fetchById: fetchById
  };
};

var _default = useApi;
exports["default"] = _default;